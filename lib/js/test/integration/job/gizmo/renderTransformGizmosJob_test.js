'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Sinon = require("wonder-bs-sinon/lib/js/src/sinon.js");
var Sinon$1 = require("sinon");
var Caml_option = require("bs-platform/lib/js/caml_option.js");
var Wonder_jest = require("wonder-bs-jest/lib/js/src/wonder_jest.js");
var MainUtils$WonderEditor = require("../../../../src/core/utils/engine/MainUtils.js");
var SinonTool$WonderEditor = require("../../../tool/SinonTool.js");
var OptionService$WonderEditor = require("../../../../src/service/primitive/OptionService.js");
var CameraPosUtils$WonderEditor = require("../../../../src/core/utils/engine/job/init/initTransformGizmosJob/rotation/CameraPosUtils.js");
var FakeGlToolEngine$WonderEditor = require("../../../tool/engine/FakeGlToolEngine.js");
var ProgramToolEngine$WonderEditor = require("../../../tool/engine/ProgramToolEngine.js");
var SettingToolEngine$WonderEditor = require("../../../tool/engine/SettingToolEngine.js");
var StateLogicService$WonderEditor = require("../../../../src/service/stateTuple/logic/StateLogicService.js");
var DirectorToolEngine$WonderEditor = require("../../../tool/engine/DirectorToolEngine.js");
var GeometryToolEngine$WonderEditor = require("../../../tool/engine/GeometryToolEngine.js");
var StateEditorService$WonderEditor = require("../../../../src/service/state/editor/StateEditorService.js");
var StateEngineService$WonderEditor = require("../../../../src/service/state/engine/state/StateEngineService.js");
var MainEditorSceneTool$WonderEditor = require("../../../tool/MainEditorSceneTool.js");
var TransformGizmosTool$WonderEditor = require("../tool/TransformGizmosTool.js");
var MainEditorCameraTool$WonderEditor = require("../../../tool/MainEditorCameraTool.js");
var GeometryEngineService$WonderEditor = require("../../../../src/service/state/engine/GeometryEngineService.js");
var GLSLLocationToolEngine$WonderEditor = require("../../../tool/engine/GLSLLocationToolEngine.js");
var TransformEngineService$WonderEditor = require("../../../../src/service/state/engine/TransformEngineService.js");
var NoWorkerJobConfigToolEngine$WonderEditor = require("../../../tool/engine/NoWorkerJobConfigToolEngine.js");
var NoMaterialShaderEngineService$WonderEditor = require("../../../../src/service/state/engine/NoMaterialShaderEngineService.js");
var GameObjectComponentEngineService$WonderEditor = require("../../../../src/service/state/engine/gameObject/GameObjectComponentEngineService.js");
var MainEditorInspectorAddComponentTool$WonderEditor = require("../../inspector/atom_component/addableComponent/tool/MainEditorInspectorAddComponentTool.js");
var OperateRotationGizmoSceneViewEditorService$WonderEditor = require("../../../../src/service/state/editor/view/sceneView/transform/rotation/OperateRotationGizmoSceneViewEditorService.js");
var CurrentTransformGizmoSceneViewEditorService$WonderEditor = require("../../../../src/service/state/editor/view/sceneView/transform/CurrentTransformGizmoSceneViewEditorService.js");
var OperateTranslationGizmoSceneViewEditorService$WonderEditor = require("../../../../src/service/state/editor/view/sceneView/transform/translation/OperateTranslationGizmoSceneViewEditorService.js");

Wonder_jest.describe("render transform gizmos job", (function (param) {
        var sandbox = Sinon.getSandboxDefaultVal(/* () */0);
        beforeEach((function () {
                sandbox[0] = Sinon$1.sandbox.create();
                MainEditorSceneTool$WonderEditor.initStateWithJob(sandbox, NoWorkerJobConfigToolEngine$WonderEditor.buildNoWorkerJobConfig(undefined, "\n            [\n        {\n          \"name\": \"default\",\n          \"jobs\": [\n            {\n              \"name\": \"init_transform_gizmos\"\n            },\n      {\n        \"name\": \"init_no_material_shader\"\n      },\n            {\n              \"name\": \"init_basic_material\"\n            },\n            {\n              \"name\": \"init_light_material\"\n            }\n          ]\n        }\n      ]\n            ", "\n             [\n         {\n           \"name\": \"default\",\n           \"jobs\": [\n            {\n                \"name\": \"get_camera_data\"\n            },\n            {\n                \"name\": \"create_basic_render_object_buffer\"\n            },\n            {\n                \"name\": \"create_light_render_object_buffer\"\n            },\n{\"name\": \"render_transform_gizmos\" }\n           ]\n         }\n       ]\n             ", undefined, undefined, /* () */0), SettingToolEngine$WonderEditor.buildBufferConfigStr(undefined, 100, 100, 100, 100, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), undefined, false, undefined, /* () */0);
                return MainEditorSceneTool$WonderEditor.createDefaultSceneAndNotInit(sandbox);
              }));
        afterEach((function () {
                return Curry._1(Sinon.restoreSandbox, sandbox[0]);
              }));
        return Wonder_jest.describe("if has current scene tree node", (function (param) {
                      beforeEach((function () {
                              return MainEditorSceneTool$WonderEditor.setFirstCubeToBeCurrentSceneTreeNode(/* () */0);
                            }));
                      Wonder_jest.test("if current scene tree node has arcballCameraController component, not render gizmo", (function (param) {
                              MainEditorInspectorAddComponentTool$WonderEditor.addArcballCameraControllerComponent(undefined, undefined, undefined, /* () */0);
                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                              var drawElements = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                              var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(drawElements), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                              var engineState$2 = MainUtils$WonderEditor._handleEngineState(engineState$1);
                              StateLogicService$WonderEditor.getAndSetEditorState(CurrentTransformGizmoSceneViewEditorService$WonderEditor.markScale);
                              var engineState$3 = DirectorToolEngine$WonderEditor.runWithDefaultTime(engineState$2);
                              StateEditorService$WonderEditor.getState(/* () */0);
                              var match = GeometryEngineService$WonderEditor.createCubeGeometry(engineState$3);
                              return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(match[1], match[0]), drawElements))), 0);
                            }));
                      return Wonder_jest.describe("else", (function (param) {
                                    Wonder_jest.describe("render translation gizmos", (function (param) {
                                            Wonder_jest.describe("render axis gizmos", (function (param) {
                                                    var _getArrowGeometry = function (editorState, engineState) {
                                                      return GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(TransformGizmosTool$WonderEditor.getArrowGameObject(editorState, engineState), engineState);
                                                    };
                                                    var _getLineGeometry = function (editorState, engineState) {
                                                      return GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState), engineState);
                                                    };
                                                    Wonder_jest.describe("prepare gl state", (function (param) {
                                                            return Wonder_jest.test("disable depth test", (function (param) {
                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                          var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                          return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, disable)));
                                                                        }));
                                                          }));
                                                    Wonder_jest.test("use one program", (function (param) {
                                                            var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                            var useProgram = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                            var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(useProgram), undefined, /* () */0), engineState);
                                                            DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                            return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(useProgram)), 1);
                                                          }));
                                                    Wonder_jest.describe("send gl data", (function (param) {
                                                            Wonder_jest.describe("send attribute", (function (param) {
                                                                    return Wonder_jest.describe("init vbo buffers when first send", (function (param) {
                                                                                  var _prepareForBufferData = function (arrowPoints, linePoints, countTuple) {
                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                    var bufferData = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(bufferData), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                    DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                    return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                                    Sinon.getCallCount(Sinon.withThreeArgs(1, arrowPoints, 2, bufferData)),
                                                                                                    Sinon.getCallCount(Sinon.withThreeArgs(1, linePoints, 2, bufferData))
                                                                                                  ]), countTuple);
                                                                                  };
                                                                                  beforeEach((function () {
                                                                                          return StateLogicService$WonderEditor.getAndSetEngineState(MainUtils$WonderEditor._handleEngineState);
                                                                                        }));
                                                                                  Wonder_jest.describe("init vertex buffer", (function (param) {
                                                                                          return Wonder_jest.test("bufferData arrow and line vertices three times", (function (param) {
                                                                                                        var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                        var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                        return _prepareForBufferData(GeometryToolEngine$WonderEditor.getGameObjectVertices(TransformGizmosTool$WonderEditor.getArrowGameObject(editorState, engineState), engineState), GeometryToolEngine$WonderEditor.getGameObjectVertices(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState), engineState), /* tuple */[
                                                                                                                    3,
                                                                                                                    3
                                                                                                                  ]);
                                                                                                      }));
                                                                                        }));
                                                                                  Wonder_jest.describe("not init texCoord buffer", (function (param) {
                                                                                          return Wonder_jest.test("not bufferData arrow and line texCoords", (function (param) {
                                                                                                        var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                        var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                        return _prepareForBufferData(GeometryToolEngine$WonderEditor.getGameObjectTexCoords(TransformGizmosTool$WonderEditor.getArrowGameObject(editorState, engineState), engineState), GeometryToolEngine$WonderEditor.getGameObjectTexCoords(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState), engineState), /* tuple */[
                                                                                                                    0,
                                                                                                                    0
                                                                                                                  ]);
                                                                                                      }));
                                                                                        }));
                                                                                  return Wonder_jest.describe("init index buffer", (function (param) {
                                                                                                return Wonder_jest.test("bufferData", (function (param) {
                                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                              var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                              var bufferData = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                              var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(bufferData), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                              var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(engineState$1);
                                                                                                              var arrowIndices = GeometryToolEngine$WonderEditor.getGameObjectIndices16(TransformGizmosTool$WonderEditor.getArrowGameObject(editorState, engineState$2), engineState$2);
                                                                                                              var lineIndices = GeometryToolEngine$WonderEditor.getGameObjectIndices16(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState$2), engineState$2);
                                                                                                              return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                                                              Sinon.getCallCount(Sinon.withThreeArgs(1, arrowIndices, 2, bufferData)),
                                                                                                                              Sinon.getCallCount(Sinon.withThreeArgs(1, lineIndices, 2, bufferData))
                                                                                                                            ]), /* tuple */[
                                                                                                                          3,
                                                                                                                          3
                                                                                                                        ]);
                                                                                                            }));
                                                                                              }));
                                                                                }));
                                                                  }));
                                                            return Wonder_jest.describe("send uniform data", (function (param) {
                                                                          Wonder_jest.describe("test send model data", (function (param) {
                                                                                  return Wonder_jest.describe("send u_mMatrix", (function (param) {
                                                                                                return Wonder_jest.test("test send each axis->arrow and line gameObjects->u_mMatrix", (function (param) {
                                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                              var uniformMatrix4fv = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                              var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_mMatrix");
                                                                                                              var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniformMatrix4fv), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                              DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                                              return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(10, uniformMatrix4fv))), 6);
                                                                                                            }));
                                                                                              }));
                                                                                }));
                                                                          return Wonder_jest.describe("test send material data", (function (param) {
                                                                                        Wonder_jest.describe("send u_alpha", (function (param) {
                                                                                                return Wonder_jest.test("test send axis gameObjects->u_alpha with 1.0", (function (param) {
                                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                              var uniform1f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                              var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_alpha");
                                                                                                              var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform1f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                              DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                                              return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(10, 1.0, uniform1f))), 1);
                                                                                                            }));
                                                                                              }));
                                                                                        return Wonder_jest.describe("send u_color", (function (param) {
                                                                                                      return Wonder_jest.test("test send each axis gameObject->u_color", (function (param) {
                                                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                    var uniform3f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                    var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_color");
                                                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform3f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                    DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                                                    return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(10, uniform3f))), 3);
                                                                                                                  }));
                                                                                                    }));
                                                                                      }));
                                                                        }));
                                                          }));
                                                    Wonder_jest.describe("draw", (function (param) {
                                                            return Wonder_jest.test("draw each axis->arrow and line gameObjects", (function (param) {
                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                          var drawElements = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(drawElements), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                          var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                          var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                          Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(_getArrowGeometry(editorState, engineState$2), engineState$2), drawElements)),
                                                                                          Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(_getLineGeometry(editorState, engineState$2), engineState$2), drawElements))
                                                                                        ]), /* tuple */[
                                                                                      3,
                                                                                      3
                                                                                    ]);
                                                                        }));
                                                          }));
                                                    return Wonder_jest.describe("restore gl state", (function (param) {
                                                                  return Wonder_jest.test("enable depth test", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, enable)));
                                                                              }));
                                                                }));
                                                  }));
                                            return Wonder_jest.describe("render plane gizmos", (function (param) {
                                                          Wonder_jest.describe("prepare gl state", (function (param) {
                                                                  Wonder_jest.test("disable depth write", (function (param) {
                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                          var depthMask = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(depthMask), undefined, undefined, /* () */0), engineState);
                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                          return Sinon.toCalledWith(/* array */[false], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, depthMask)));
                                                                        }));
                                                                  Wonder_jest.test("disable depth test", (function (param) {
                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                          var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                          return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(1, disable)));
                                                                        }));
                                                                  Wonder_jest.test("set side to both", (function (param) {
                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                          var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                          return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(2, disable)));
                                                                        }));
                                                                  return Wonder_jest.describe("open blend", (function (param) {
                                                                                Wonder_jest.test("enable blend", (function (param) {
                                                                                        var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                        var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                        var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                        DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                        return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(1, enable)));
                                                                                      }));
                                                                                return Wonder_jest.test("set blend func", (function (param) {
                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                              var blendFunc = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                              var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(blendFunc), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                              DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                              return Sinon.toCalledWith(/* array */[
                                                                                                          1,
                                                                                                          2
                                                                                                        ], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, blendFunc)));
                                                                                            }));
                                                                              }));
                                                                }));
                                                          Wonder_jest.test("use the same program", (function (param) {
                                                                  var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                  var useProgram = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                  var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(useProgram), undefined, /* () */0), engineState);
                                                                  DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                  return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(useProgram)), 1);
                                                                }));
                                                          Wonder_jest.describe("send gl data", (function (param) {
                                                                  Wonder_jest.describe("send attribute", (function (param) {
                                                                          return Wonder_jest.describe("init vbo buffers when first send", (function (param) {
                                                                                        var _prepareForBufferData = function (planePoints, count) {
                                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                          var bufferData = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(bufferData), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withThreeArgs(1, planePoints, 2, bufferData))), count);
                                                                                        };
                                                                                        beforeEach((function () {
                                                                                                return StateLogicService$WonderEditor.getAndSetEngineState(MainUtils$WonderEditor._handleEngineState);
                                                                                              }));
                                                                                        Wonder_jest.describe("init vertex buffer", (function (param) {
                                                                                                return Wonder_jest.test("bufferData plane vertices three times", (function (param) {
                                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                              var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                              return _prepareForBufferData(GeometryToolEngine$WonderEditor.getGameObjectVertices(GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(OperateTranslationGizmoSceneViewEditorService$WonderEditor.unsafeGetTranslationXYPlaneGizmo(editorState), engineState), engineState), 3);
                                                                                                            }));
                                                                                              }));
                                                                                        Wonder_jest.describe("not init texCoord buffer", (function (param) {
                                                                                                return Wonder_jest.test("bufferData arrow and line texCoords three times", (function (param) {
                                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                              var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                              return _prepareForBufferData(GeometryToolEngine$WonderEditor.getGameObjectTexCoords(GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(OperateTranslationGizmoSceneViewEditorService$WonderEditor.unsafeGetTranslationXYPlaneGizmo(editorState), engineState), engineState), 0);
                                                                                                            }));
                                                                                              }));
                                                                                        return Wonder_jest.describe("init index buffer", (function (param) {
                                                                                                      return Wonder_jest.test("bufferData", (function (param) {
                                                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                    var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                                    var bufferData = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(bufferData), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                    var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(engineState$1);
                                                                                                                    GeometryToolEngine$WonderEditor.getGameObjectIndices16(TransformGizmosTool$WonderEditor.getArrowGameObject(editorState, engineState$2), engineState$2);
                                                                                                                    GeometryToolEngine$WonderEditor.getGameObjectIndices16(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState$2), engineState$2);
                                                                                                                    return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withThreeArgs(1, GeometryEngineService$WonderEditor.unsafeGetGeometryIndices16(GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(OperateTranslationGizmoSceneViewEditorService$WonderEditor.unsafeGetTranslationXYPlaneGizmo(editorState), engineState$2), engineState$2), 2, bufferData))), 3);
                                                                                                                  }));
                                                                                                    }));
                                                                                      }));
                                                                        }));
                                                                  return Wonder_jest.describe("send uniform data", (function (param) {
                                                                                Wonder_jest.describe("test send model data", (function (param) {
                                                                                        return Wonder_jest.describe("send u_mMatrix", (function (param) {
                                                                                                      return Wonder_jest.test("test 3 plane gameObjects->u_mMatrix", (function (param) {
                                                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                    var uniformMatrix4fv = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                    var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_mMatrix");
                                                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniformMatrix4fv), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                    DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                                                    return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(10, uniformMatrix4fv))), 3);
                                                                                                                  }));
                                                                                                    }));
                                                                                      }));
                                                                                return Wonder_jest.describe("test send material data", (function (param) {
                                                                                              Wonder_jest.describe("send u_alpha", (function (param) {
                                                                                                      return Wonder_jest.test("test send 3 planes->u_alpha with 0.3", (function (param) {
                                                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                    var uniform1f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                    var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_alpha");
                                                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform1f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                    DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                                                    return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(10, 0.30000001192092896, uniform1f))), 1);
                                                                                                                  }));
                                                                                                    }));
                                                                                              return Wonder_jest.describe("send u_color", (function (param) {
                                                                                                            return Wonder_jest.test("test send 3 plane gameObjects->u_color", (function (param) {
                                                                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                          var uniform3f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                          var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_color");
                                                                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform3f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(10, uniform3f))), 3);
                                                                                                                        }));
                                                                                                          }));
                                                                                            }));
                                                                              }));
                                                                }));
                                                          Wonder_jest.describe("draw", (function (param) {
                                                                  return Wonder_jest.test("draw 3 plane gameObjects", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var drawElements = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(drawElements), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(OperateTranslationGizmoSceneViewEditorService$WonderEditor.unsafeGetTranslationXYPlaneGizmo(editorState), engineState$2), engineState$2), drawElements))), 3);
                                                                              }));
                                                                }));
                                                          return Wonder_jest.describe("restore gl state", (function (param) {
                                                                        Wonder_jest.test("enable depth write", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var depthMask = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(depthMask), undefined, undefined, /* () */0), engineState);
                                                                                DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                return Sinon.toCalledWith(/* array */[true], Wonder_jest.Expect[/* expect */0](Sinon.getCall(1, depthMask)));
                                                                              }));
                                                                        Wonder_jest.test("enable depth test", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(2, enable)));
                                                                              }));
                                                                        Wonder_jest.test("set side to front", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var cullFace = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 2, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, Caml_option.some(cullFace), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                var __x = Sinon.getCall(3, enable);
                                                                                var __x$1 = Sinon.getCall(0, cullFace);
                                                                                return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                                SinonTool$WonderEditor.calledWith(__x, 1),
                                                                                                SinonTool$WonderEditor.calledWith(__x$1, 2)
                                                                                              ]), /* tuple */[
                                                                                            true,
                                                                                            true
                                                                                          ]);
                                                                              }));
                                                                        return Wonder_jest.test("disable blend", (function (param) {
                                                                                      var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                      var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                      var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 10, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                      DirectorToolEngine$WonderEditor.runWithDefaultTime(MainUtils$WonderEditor._handleEngineState(engineState$1));
                                                                                      return Sinon.toCalledWith(/* array */[10], Wonder_jest.Expect[/* expect */0](Sinon.getCall(3, disable)));
                                                                                    }));
                                                                      }));
                                                        }));
                                          }));
                                    Wonder_jest.describe("render rotation gizmos", (function (param) {
                                            return Wonder_jest.describe("render circle gizmos", (function (param) {
                                                          var _handleEngineState = function (engineState) {
                                                            var engineState$1 = MainUtils$WonderEditor._handleEngineState(engineState);
                                                            StateLogicService$WonderEditor.getAndSetEditorState(CurrentTransformGizmoSceneViewEditorService$WonderEditor.markRotation);
                                                            return engineState$1;
                                                          };
                                                          Wonder_jest.describe("prepare gl state", (function (param) {
                                                                  Wonder_jest.test("disable depth test", (function (param) {
                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                          var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                          return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, disable)));
                                                                        }));
                                                                  return Wonder_jest.describe("open blend", (function (param) {
                                                                                Wonder_jest.test("enable blend", (function (param) {
                                                                                        var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                        var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                        var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                        DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                        return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, enable)));
                                                                                      }));
                                                                                return Wonder_jest.test("set blend func", (function (param) {
                                                                                              var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                              var blendFunc = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                              var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(blendFunc), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                              DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                              return Sinon.toCalledWith(/* array */[
                                                                                                          1,
                                                                                                          2
                                                                                                        ], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, blendFunc)));
                                                                                            }));
                                                                              }));
                                                                }));
                                                          Wonder_jest.test("use no material shader->rotation_gizmo_for_editor", (function (param) {
                                                                  var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                  var createProgram = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                  Sinon.returns(1, Sinon.onCall(0, createProgram));
                                                                  Sinon.returns(2, Sinon.onCall(1, createProgram));
                                                                  Sinon.returns(3, Sinon.onCall(2, createProgram));
                                                                  var useProgram = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                  var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(createProgram), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(useProgram), undefined, /* () */0), engineState);
                                                                  var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                  var shaderIndex = NoMaterialShaderEngineService$WonderEditor.unsafeGetNoMaterialShader("rotation_gizmo_for_editor", engineState$2);
                                                                  return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                  Sinon.getCallCount(useProgram),
                                                                                  SinonTool$WonderEditor.calledWith(useProgram, ProgramToolEngine$WonderEditor.getProgram(shaderIndex, engineState$2)),
                                                                                  ProgramToolEngine$WonderEditor.getProgram(shaderIndex, engineState$2)
                                                                                ]), /* tuple */[
                                                                              1,
                                                                              true,
                                                                              1
                                                                            ]);
                                                                }));
                                                          Wonder_jest.describe("send gl data", (function (param) {
                                                                  return Wonder_jest.describe("send uniform data", (function (param) {
                                                                                return Wonder_jest.describe("test send no material shader data", (function (param) {
                                                                                              var _prepareCamera = function (param) {
                                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                var __x = OptionService$WonderEditor.unsafeGet(MainEditorCameraTool$WonderEditor.getCurrentCameraGameObject(engineState));
                                                                                                var currentCameraTransform = GameObjectComponentEngineService$WonderEditor.unsafeGetTransformComponent(__x, engineState);
                                                                                                var engineState$1 = TransformEngineService$WonderEditor.lookAt(currentCameraTransform, /* tuple */[
                                                                                                      0,
                                                                                                      0,
                                                                                                      0
                                                                                                    ], TransformEngineService$WonderEditor.setLocalPosition(/* tuple */[
                                                                                                          0,
                                                                                                          2,
                                                                                                          3
                                                                                                        ], currentCameraTransform, engineState));
                                                                                                StateEngineService$WonderEditor.setState(engineState$1);
                                                                                                return /* () */0;
                                                                                              };
                                                                                              Wonder_jest.describe("send u_alpha", (function (param) {
                                                                                                      var _test = function (alpha, count) {
                                                                                                        var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                        var uniform1f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                        var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_alpha");
                                                                                                        var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform1f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                        DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                                        return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(10, alpha, uniform1f))), count);
                                                                                                      };
                                                                                                      beforeEach((function () {
                                                                                                              return _prepareCamera(/* () */0);
                                                                                                            }));
                                                                                                      Wonder_jest.test("if circle gizmo is unused, send small value", (function (param) {
                                                                                                              return _test(0.1, 1);
                                                                                                            }));
                                                                                                      return Wonder_jest.test("else, send 1.0", (function (param) {
                                                                                                                    return _test(1.0, 1);
                                                                                                                  }));
                                                                                                    }));
                                                                                              Wonder_jest.describe("send u_color", (function (param) {
                                                                                                      return Wonder_jest.test("test send each circle gameObject->u_color", (function (param) {
                                                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                    var uniform3f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                    var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_color");
                                                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform3f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                    DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                                                    return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(10, uniform3f))), 3);
                                                                                                                  }));
                                                                                                    }));
                                                                                              return Wonder_jest.describe("send u_cameraPosInLocalCoordSystem", (function (param) {
                                                                                                            return Wonder_jest.test("send send each circle gameObject->camera pos in local coord system", (function (param) {
                                                                                                                          _prepareCamera(/* () */0);
                                                                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                          var uniform3f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                          var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_cameraPosInLocalCoordSystem");
                                                                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform3f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                          var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                                                          var match = CameraPosUtils$WonderEditor.getCameraPos(StateEditorService$WonderEditor.getState(/* () */0), engineState$2);
                                                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                                                                          Sinon.getCallCount(Sinon.withFourArgs(10, match[0], match[1], match[2], uniform3f)),
                                                                                                                                          Sinon.getCallCount(Sinon.withFourArgs(10, 0, 3.0000004260849593, -2.000000135732943, uniform3f)),
                                                                                                                                          Sinon.getCallCount(Sinon.withFourArgs(10, -3.0000003576278687, 2, 1.0268563599424851e-7, uniform3f))
                                                                                                                                        ]), /* tuple */[
                                                                                                                                      1,
                                                                                                                                      1,
                                                                                                                                      1
                                                                                                                                    ]);
                                                                                                                        }));
                                                                                                          }));
                                                                                            }));
                                                                              }));
                                                                }));
                                                          Wonder_jest.describe("draw", (function (param) {
                                                                  return Wonder_jest.test("draw each circle gameObject with line_strip", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var drawElements = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(drawElements), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(OperateRotationGizmoSceneViewEditorService$WonderEditor.unsafeGetRotationXYCircleGizmo(editorState), engineState$2), engineState$2), drawElements))), 3);
                                                                              }));
                                                                }));
                                                          return Wonder_jest.describe("restore gl state", (function (param) {
                                                                        Wonder_jest.test("enable depth test", (function (param) {
                                                                                var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(1, enable)));
                                                                              }));
                                                                        return Wonder_jest.test("disable blend", (function (param) {
                                                                                      var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                      var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                      var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 10, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                      DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                      return Sinon.toCalledWith(/* array */[10], Wonder_jest.Expect[/* expect */0](Sinon.getCall(1, disable)));
                                                                                    }));
                                                                      }));
                                                        }));
                                          }));
                                    return Wonder_jest.describe("render scale gizmos", (function (param) {
                                                  var _handleEngineState = function (engineState) {
                                                    var engineState$1 = MainUtils$WonderEditor._handleEngineState(engineState);
                                                    StateLogicService$WonderEditor.getAndSetEditorState(CurrentTransformGizmoSceneViewEditorService$WonderEditor.markScale);
                                                    return engineState$1;
                                                  };
                                                  return Wonder_jest.describe("render axis gizmos and center box gizmo", (function (param) {
                                                                var _getLineGeometry = function (editorState, engineState) {
                                                                  return GameObjectComponentEngineService$WonderEditor.unsafeGetGeometryComponent(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState), engineState);
                                                                };
                                                                Wonder_jest.describe("prepare gl state", (function (param) {
                                                                        return Wonder_jest.test("disable depth test", (function (param) {
                                                                                      var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                      var disable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                      var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(disable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                      DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                      return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, disable)));
                                                                                    }));
                                                                      }));
                                                                Wonder_jest.test("use one program", (function (param) {
                                                                        var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                        var useProgram = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                        var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(useProgram), undefined, /* () */0), engineState);
                                                                        DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                        return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(useProgram)), 1);
                                                                      }));
                                                                Wonder_jest.describe("send gl data", (function (param) {
                                                                        Wonder_jest.describe("send attribute", (function (param) {
                                                                                return Wonder_jest.describe("init vbo buffers when first send", (function (param) {
                                                                                              beforeEach((function () {
                                                                                                      return StateLogicService$WonderEditor.getAndSetEngineState(_handleEngineState);
                                                                                                    }));
                                                                                              return Wonder_jest.describe("init vertex buffer", (function (param) {
                                                                                                            return Wonder_jest.test("bufferData cube geometry vertices(3 cube gameObjects+1 center box gameObject) four times and line vertices three times", (function (param) {
                                                                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                          var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                                                          var match = GeometryEngineService$WonderEditor.createCubeGeometry(engineState);
                                                                                                                          var engineState$1 = match[0];
                                                                                                                          var cubeGeometryPoints = GeometryEngineService$WonderEditor.unsafeGetGeometryVertices(match[1], engineState$1);
                                                                                                                          var linePoints = GeometryToolEngine$WonderEditor.getGameObjectVertices(TransformGizmosTool$WonderEditor.getLineGameObject(editorState, engineState$1), engineState$1);
                                                                                                                          var countTuple = /* tuple */[
                                                                                                                            4,
                                                                                                                            3
                                                                                                                          ];
                                                                                                                          var engineState$2 = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                          var bufferData = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                          var engineState$3 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(bufferData), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState$2);
                                                                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$3));
                                                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                                                                          Sinon.getCallCount(Sinon.withThreeArgs(1, cubeGeometryPoints, 2, bufferData)),
                                                                                                                                          Sinon.getCallCount(Sinon.withThreeArgs(1, linePoints, 2, bufferData))
                                                                                                                                        ]), countTuple);
                                                                                                                        }));
                                                                                                          }));
                                                                                            }));
                                                                              }));
                                                                        return Wonder_jest.describe("send uniform data", (function (param) {
                                                                                      Wonder_jest.describe("test send model data", (function (param) {
                                                                                              return Wonder_jest.describe("send u_mMatrix", (function (param) {
                                                                                                            return Wonder_jest.test("test send each axis->arrow and line gameObjects and center box->u_mMatrix", (function (param) {
                                                                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                          var uniformMatrix4fv = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                          var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_mMatrix");
                                                                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniformMatrix4fv), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(10, uniformMatrix4fv))), 7);
                                                                                                                        }));
                                                                                                          }));
                                                                                            }));
                                                                                      return Wonder_jest.describe("test send material data", (function (param) {
                                                                                                    Wonder_jest.describe("send u_alpha", (function (param) {
                                                                                                            return Wonder_jest.test("test send axis gameObjects and center box gameObject->u_alpha with 1.0", (function (param) {
                                                                                                                          var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                          var uniform1f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                          var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_alpha");
                                                                                                                          var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform1f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                          DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withTwoArgs(10, 1.0, uniform1f))), 1);
                                                                                                                        }));
                                                                                                          }));
                                                                                                    return Wonder_jest.describe("send u_color", (function (param) {
                                                                                                                  var _prepareAndExec = function (sandbox) {
                                                                                                                    var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                                                    var uniform3f = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                                                    var getUniformLocation = GLSLLocationToolEngine$WonderEditor.getUniformLocation(10, sandbox, "u_color");
                                                                                                                    var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(getUniformLocation), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(uniform3f), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                                                    DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                                                    return /* tuple */[
                                                                                                                            10,
                                                                                                                            uniform3f
                                                                                                                          ];
                                                                                                                  };
                                                                                                                  Wonder_jest.test("test send each axis gameObject->u_color", (function (param) {
                                                                                                                          var match = _prepareAndExec(sandbox);
                                                                                                                          return Curry._2(Wonder_jest.Expect[/* Operators */25][/* >= */2], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withOneArg(match[0], match[1]))), 3);
                                                                                                                        }));
                                                                                                                  return Wonder_jest.test("test send center box gameObject->u_color", (function (param) {
                                                                                                                                var match = _prepareAndExec(sandbox);
                                                                                                                                return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](Sinon.getCallCount(Sinon.withFourArgs(match[0], 0.800000011920929, 0.800000011920929, 0.800000011920929, match[1]))), 1);
                                                                                                                              }));
                                                                                                                }));
                                                                                                  }));
                                                                                    }));
                                                                      }));
                                                                Wonder_jest.describe("draw", (function (param) {
                                                                        return Wonder_jest.test("draw each axis->arrow and line gameObjects and center box gameObject", (function (param) {
                                                                                      var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                      var drawElements = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                      var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 2, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(drawElements), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                      var engineState$2 = DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                      var editorState = StateEditorService$WonderEditor.getState(/* () */0);
                                                                                      var match = GeometryEngineService$WonderEditor.createCubeGeometry(engineState$2);
                                                                                      var engineState$3 = match[0];
                                                                                      return Curry._2(Wonder_jest.Expect[/* Operators */25][/* = */5], Wonder_jest.Expect[/* expect */0](/* tuple */[
                                                                                                      Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(match[1], engineState$3), drawElements)),
                                                                                                      Sinon.getCallCount(Sinon.withTwoArgs(2, GeometryEngineService$WonderEditor.getIndicesCount(_getLineGeometry(editorState, engineState$3), engineState$3), drawElements))
                                                                                                    ]), /* tuple */[
                                                                                                  4,
                                                                                                  3
                                                                                                ]);
                                                                                    }));
                                                                      }));
                                                                return Wonder_jest.describe("restore gl state", (function (param) {
                                                                              return Wonder_jest.test("enable depth test", (function (param) {
                                                                                            var engineState = StateEngineService$WonderEditor.unsafeGetState(/* () */0);
                                                                                            var enable = Sinon.createEmptyStubWithJsObjSandbox(sandbox);
                                                                                            var engineState$1 = FakeGlToolEngine$WonderEditor.setFakeGl(FakeGlToolEngine$WonderEditor.buildFakeGl(sandbox, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, Caml_option.some(enable), undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, /* () */0), engineState);
                                                                                            DirectorToolEngine$WonderEditor.runWithDefaultTime(_handleEngineState(engineState$1));
                                                                                            return Sinon.toCalledWith(/* array */[1], Wonder_jest.Expect[/* expect */0](Sinon.getCall(0, enable)));
                                                                                          }));
                                                                            }));
                                                              }));
                                                }));
                                  }));
                    }));
      }));

/*  Not a pure module */
